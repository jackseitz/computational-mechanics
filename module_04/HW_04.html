

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Homework &#8212; Computational Mechanics</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=bd9e20870c6007c4c509" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=bd9e20870c6007c4c509" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=bd9e20870c6007c4c509"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'module_04/HW_04';</script>
    <link rel="shortcut icon" href="../_static/spiderman-favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="CompMech04-Linear Algebra Project" href="../projects/04_Linear_Algebra-project.html" />
    <link rel="prev" title="Linear Regression Algebra" href="03_Linear-regression-algebra.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <header>
  
    <div class="bd-header navbar navbar-expand-lg bd-navbar">
    </div>
  
  </header>

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../README.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/comp-mech-logo.svg" class="logo__image only-light" alt="Computational Mechanics - Home"/>
    <script>document.write(`<img src="../_static/comp-mech-logo.svg" class="logo__image only-dark" alt="Computational Mechanics - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../README.html">
                    Computational Mechanics
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../syllabus.html">Syllabus - Computational Mechanics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../how-to/update-github.html">Working in your  Fork on GitHub.com</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../module_01/README.html">Computational Mechanics 01 - Getting Started</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../module_01/01_Interacting_with_Python.html">01 - Interacting with Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_01/02_Working_with_Python.html">02 - Working with Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_01/03_Numerical_error.html">03 - Numerical Error</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_01/HW_01.html">Homework</a></li>
<li class="toctree-l2"><a class="reference internal" href="../projects/01_Getting-started-project.html">Computational Mechanics Project #01 - Heat Transfer in Forensic Science</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../module_02/README.html">Computational Mechanics 02 - Analyze Data</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../module_02/01_Cheers_Stats_Beers.html">01 - Cheers!  Stats with Beers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_02/02_Seeing_Stats.html">02 - Seeing stats in a new light</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_02/03_Linear_Regression_with_Real_Data.html">03 - Linear regression with real data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_02/04_Stats_and_Montecarlo.html">04 - Statistics and Monte-Carlo Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_02/HW_02.html">Homework</a></li>
<li class="toctree-l2"><a class="reference internal" href="../projects/02_Analyze-data_project.html">Project #02 - NYSE random walk predictor</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../module_03/README.html">Computational Mechanics 03- Initial Value Problems</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../module_03/01_Catch_Motion.html">Catch things in motion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_03/02_Step_Future.html">Step to the future</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_03/03_Get_Oscillations.html">Get with the oscillations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_03/04_Getting_to_the_root.html">Roots of Nonlinear functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_03/HW_03.html">Homework</a></li>
<li class="toctree-l2"><a class="reference internal" href="../projects/03_IVP-project.html">Initial Value Problems - Project</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="README.html">Computational Mechanics 4 - Linear Algebra</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="01_Linear-Algebra.html">Linear Algebra Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="02_Gauss_elimination.html">Gauss Elimination</a></li>
<li class="toctree-l2"><a class="reference internal" href="03_Linear-regression-algebra.html">Linear Regression Algebra</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Homework</a></li>
<li class="toctree-l2"><a class="reference internal" href="../projects/04_Linear_Algebra-project.html">CompMech04-Linear Algebra Project</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../module_05/README.html">Computational Mechanics 5 - Boundary Value Problems</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../module_05/01_Revisiting_derivatives.html">Revisiting Derivatives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_05/02_Keep_it_steady.html">Keep it Steady</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_05/03_Good_Vibrations.html">Good Vibrations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_05/HW_05.html">Homework</a></li>
<li class="toctree-l2"><a class="reference internal" href="../projects/05-BVPs_project.html">Computational Mechanics Boundary Values - Project 05</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../how-to/README.html">Quick How-to documents</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../how-to/polyfit.html">Creating a quadratic fit on random data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../how-to/for-loops.html">How to use a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop? <em>in Python</em></a></li>
<li class="toctree-l2"><a class="reference internal" href="../projects/extra-FEA_material.html">Extra Material: Direct stiffness method for Finite Element analysis (FEA)</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/cooperrc/computational-mechanics/master?urlpath=tree/module_04/HW_04.md" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://compmech.uconn.edu/hub/user-redirect/git-pull?repo=https%3A//github.com/cooperrc/computational-mechanics&urlpath=tree/computational-mechanics/module_04/HW_04.md&branch=master" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onJupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/cooperrc/computational-mechanics" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/cooperrc/computational-mechanics/issues/new?title=Issue%20on%20page%20%2Fmodule_04/HW_04.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/module_04/HW_04.ipynb" target="_blank"
   class="btn btn-sm btn-download-notebook-button dropdown-item"
   title="Download notebook file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li><a href="../_sources/module_04/HW_04.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Homework</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#problems-part-1">Problems <span class="xref myst">Part 1</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#problems-part-2">Problems <span class="xref myst">Part 2</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#problems-part-3">Problems <span class="xref myst">Part 3</span></a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="homework">
<h1>Homework<a class="headerlink" href="#homework" title="Permalink to this heading">#</a></h1>
<section id="problems-part-1">
<h2>Problems <a class="reference internal" href="01_Linear-Algebra.html"><span class="doc std std-doc">Part 1</span></a><a class="headerlink" href="#problems-part-1" title="Permalink to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Consider the following pistons connected in series. You want to find
the distance each piston moves when equal and opposite forces are
applied to each side. In case 1, you consider the motion of all five
pistons, but in case 2 you set the motion of piston 5 to 0.</p></li>
</ol>
<p><img alt="Springs-masses" src="../_images/series-springs_01-02.png" /></p>
<p>Using a FBD for each piston, in case 1:</p>
<p><span class="math notranslate nohighlight">\(k_1x_{1}-k_2x_{2}=F\)</span></p>
<p><span class="math notranslate nohighlight">\((k_1 +k_2)x_2 -k_1x_1 - k_2x_3 = 0\)</span></p>
<p><span class="math notranslate nohighlight">\((k_2 +k_3)x_3 -k_2x_2 - k_3x_4 = 0\)</span></p>
<p><span class="math notranslate nohighlight">\((k_3 +k_4)x_4 -k_3x_3 - k_4x_5 = 0\)</span></p>
<p><span class="math notranslate nohighlight">\(k_4x_5 - k_4x_4 = -F\)</span></p>
<p>in matrix form:</p>
<p><span class="math notranslate nohighlight">\(\left[ \begin{array}{ccccc}
k_1 &amp; -k_1 &amp; 0 &amp; 0 &amp; 0\\
-k_1 &amp; k_1+k_2 &amp; -k_2 &amp; 0 &amp; 0 \\
0 &amp; -k_2 &amp; k_2+k_3 &amp; -k_3 &amp; 0\\
0 &amp; 0 &amp; -k_3 &amp; k_3+k_4 &amp; -k_4\\
0 &amp; 0 &amp; 0 &amp; -k_4 &amp; k_4  
\end{array} \right]
\left[ \begin{array}{c}
x_{1} \\
x_{2} \\
x_{3} \\
x_{4} \\
x_{5}\end{array} \right]=
\left[ \begin{array}{c}
F \\
0 \\
0 \\
0 \\
-F \end{array} \right]\)</span></p>
<p>Try to use <code class="docutils literal notranslate"><span class="pre">np.linalg.solve</span></code> to find the piston x-positions. Do you get
any warnings or errors? _use stiffness values of <span class="math notranslate nohighlight">\(k_* = 1\)</span> and force of
<span class="math notranslate nohighlight">\(F=1\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.linalg</span> <span class="kn">import</span> <span class="n">lu_factor</span><span class="p">,</span> <span class="n">lu_solve</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">curve_fit</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">F</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">k</span><span class="o">+</span><span class="n">k</span><span class="p">,</span> <span class="o">-</span><span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="o">-</span><span class="n">k</span><span class="p">,</span> <span class="n">k</span><span class="o">+</span><span class="n">k</span><span class="p">,</span> <span class="o">-</span><span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">k</span><span class="p">,</span> <span class="n">k</span><span class="o">+</span><span class="n">k</span><span class="p">,</span> <span class="o">-</span><span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">k</span><span class="p">,</span> <span class="n">k</span><span class="o">+</span><span class="n">k</span><span class="p">,</span> <span class="o">-</span><span class="n">k</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">k</span><span class="p">,</span> <span class="n">k</span><span class="p">]])</span>

<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">F</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">F</span><span class="p">])</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">x_positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="n">error_message</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="n">x_positions</span> <span class="o">=</span> <span class="kc">None</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The piston x positions are: &quot;</span><span class="p">,</span><span class="n">x_positions</span><span class="p">)</span>
<span class="sd">&#39;&#39;&#39;No error&#39;&#39;&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The piston x positions are:  [-1.11022302e-16 -1.00000000e+00 -2.00000000e+00 -3.00000000e+00
 -4.00000000e+00]
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;No error&#39;
</pre></div>
</div>
</div>
</div>
<p>Now, consider case 2,</p>
<p>Using a FBD for each piston, in case 2:</p>
<p><span class="math notranslate nohighlight">\(k_1x_{1}-k_2x_{2}=F\)</span></p>
<p><span class="math notranslate nohighlight">\((k_1 +k_2)x_2 -k_1x_1 - k_2x_3 = 0\)</span></p>
<p><span class="math notranslate nohighlight">\((k_2 +k_3)x_3 -k_2x_2 - k_3x_4 = 0\)</span></p>
<p><span class="math notranslate nohighlight">\((k_3 +k_4)x_4 -k_3x_3 = 0\)</span></p>
<p>in matrix form:</p>
<p><span class="math notranslate nohighlight">\(\left[ \begin{array}{cccc}
k_1 &amp; -k_1 &amp; 0 &amp; 0 \\
-k_1 &amp; k_1+k_2 &amp; -k_2 &amp; 0 \\
0 &amp; -k_2 &amp; k_2+k_3 &amp; -k_3 \\
0 &amp; 0 &amp; -k_3 &amp; k_3+k_4 \\
\end{array} \right]
\left[ \begin{array}{c}
x_{1} \\
x_{2} \\
x_{3} \\
x_{4} \end{array} \right]=
\left[ \begin{array}{c}
F \\
0 \\
0 \\
0 \end{array} \right]\)</span></p>
<p>Try to use <code class="docutils literal notranslate"><span class="pre">np.linalg.solve</span></code> to find the piston x-positions. Do you get
any warnings or errors? Why does this solution work better <span class="xref myst">hint: check
condition
numbers</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A_case2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">k</span><span class="p">,</span> <span class="o">-</span><span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="n">k</span><span class="p">,</span> <span class="n">k</span><span class="o">+</span><span class="n">k</span><span class="p">,</span> <span class="o">-</span><span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">k</span><span class="p">,</span> <span class="n">k</span><span class="o">+</span><span class="n">k</span><span class="p">,</span> <span class="o">-</span><span class="n">k</span><span class="p">],</span>
                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">k</span><span class="p">,</span> <span class="n">k</span><span class="o">+</span><span class="n">k</span><span class="p">]])</span>

<span class="n">B_case2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">F</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">x_positions_case2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A_case2</span><span class="p">,</span> <span class="n">B_case2</span><span class="p">)</span>
    <span class="n">condition_number_case2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span><span class="n">A_case2</span><span class="p">)</span>
    <span class="n">warning_or_error_case2</span> <span class="o">=</span> <span class="s2">&quot;No warnings or errors&quot;</span>
    
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="n">warning_or_error_case2</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="n">condition_number_case2</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">x_positions_case2</span> <span class="o">=</span> <span class="kc">None</span>
    
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The piston x positions are: &quot;</span><span class="p">,</span><span class="n">x_positions_case2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The condition number is: &quot;</span><span class="p">,</span><span class="n">condition_number_case2</span><span class="p">)</span>
<span class="sd">&#39;&#39;&#39;No errors. This solve works better due to the fact that this matrix has a lower and more stable condition number&#39;&#39;&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The piston x positions are:  [4. 3. 2. 1.]
The condition number is:  29.28405223595455
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;No errors. This solve works better due to the fact that this matrix has a lower and more stable condition number&#39;
</pre></div>
</div>
</div>
</div>
<p><img alt="HVAC diagram showing the flow rates and connections between floors" src="../_images/hvac.png" /></p>
<ol class="arabic simple" start="2">
<li><p>In the figure above you have an idealized Heating, Ventilation and
Air conditioning (HVAC) system. In the current configuration, the
three-room building is being cooled off by <span class="math notranslate nohighlight">\(T_{in}\)</span> air fed into the
building at $\dot{m}_1. Our goal is to determine the steady-state temperatures of the rooms given the following information</p></li>
</ol>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\dot{m}_1=0.1~kg/s\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\dot{m}_2=0.12~kg/s\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\dot{m}_3=0.12~kg/s\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\dot{m}_4=0.1~kg/s\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\dot{m}_5=0.02~kg/s\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\dot{m}_6=0.02~kg/s\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(C_p=1000~\frac{J}{kg-K}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\dot{Q}_{in} = 300~W\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(T_{in} = 12^{o} C\)</span></p></li>
</ul>
<p>The energy-balance equations for rooms 1-3 create three equations:</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(\dot{m}_1 C_p T_{in}+\dot{Q}_{in}-\dot{m}_2 C_p T_{1}+\dot{m}_6 C_p T_{2} = 0\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\dot{m}_2 C_p T_{1}+\dot{Q}_{in}+\dot{m}_5 C_p T_{3}-\dot{m}_3 C_p T_{2}-\dot{m}_6 C_p T_{2} = 0\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\dot{m}_3 C_p T_{2}+\dot{Q}_{in}-\dot{m}_5 C_p T_{3}-\dot{m}_4 C_p T_{3} = 0\)</span></p></li>
</ol>
<p>Identify the unknown variables and constants to create a linear algebra problem in the form of <span class="math notranslate nohighlight">\(\mathbf{Ax}=\mathbf{b}\)</span>.</p>
<p>a. Create the matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span></p>
<p>b. Create the known vector <span class="math notranslate nohighlight">\(\mathbf{b}\)</span></p>
<p>c. Solve for the unknown variables, <span class="math notranslate nohighlight">\(\mathbf{x}\)</span></p>
<p>d. What are the warmest and coldest rooms? What are their temperatures?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m_dot</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.12</span><span class="p">,</span> <span class="mf">0.12</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">]</span>  
<span class="n">Cp</span> <span class="o">=</span> <span class="mi">1000</span> 
<span class="n">Q_in</span> <span class="o">=</span> <span class="mi">300</span>  
<span class="n">T_in</span> <span class="o">=</span> <span class="mi">12</span>  

<span class="c1">#Part a</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="n">m_dot</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">Cp</span><span class="p">,</span> <span class="o">-</span><span class="n">m_dot</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">Cp</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="o">-</span><span class="n">m_dot</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">Cp</span><span class="p">,</span> <span class="p">(</span><span class="n">m_dot</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">m_dot</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">*</span><span class="n">Cp</span><span class="p">,</span> <span class="o">-</span><span class="n">m_dot</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">Cp</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">m_dot</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">Cp</span><span class="p">,</span> <span class="p">(</span><span class="n">m_dot</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="n">m_dot</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">*</span><span class="n">Cp</span><span class="p">]</span>
<span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Matrix A: &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Matrix A: 
[[ 100. -120.    0.]
 [-100.  240. -120.]
 [   0. -120.  220.]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Part b</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="n">Q_in</span> <span class="o">+</span> <span class="n">m_dot</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">Cp</span><span class="o">*</span><span class="n">T_in</span><span class="p">,</span>
    <span class="n">Q_in</span> <span class="o">-</span> <span class="n">m_dot</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">Cp</span><span class="o">*</span><span class="n">T_in</span><span class="p">,</span>
    <span class="n">Q_in</span> <span class="o">-</span> <span class="n">m_dot</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">Cp</span><span class="o">*</span><span class="n">T_in</span>
<span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Known vector b: &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Known vector b: 
[540.  60.  60.]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Part c</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Solved unknown variables: &quot;</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solved unknown variables:  [19.32 11.6   6.6 ]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Part d</span>
<span class="n">warmest_room_temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">coldest_room_temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">warmest_room</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>  <span class="c1">#Adding 1 to match room numbering starting from 1</span>
<span class="n">coldest_room</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warmest room: &quot;</span><span class="p">,</span><span class="n">warmest_room</span><span class="p">,</span><span class="s2">&quot;, Warmest temp: &quot;</span><span class="p">,</span> <span class="n">warmest_room_temp</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Coldest room: &quot;</span><span class="p">,</span><span class="n">coldest_room</span><span class="p">,</span><span class="s2">&quot;, Coldest temp: &quot;</span><span class="p">,</span> <span class="n">coldest_room_temp</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warmest room:  1 , Warmest temp:  19.32
Coldest room:  3 , Coldest temp:  6.6
</pre></div>
</div>
</div>
</div>
<ol class="arabic simple" start="3">
<li><p>The <a class="reference external" href="https://en.wikipedia.org/wiki/Hilbert_matrix">Hilbert Matrix</a> has a high condition number and as the matrix increases dimensions, the condition number increases. Find the condition number of a</p></li>
</ol>
<p>a. <span class="math notranslate nohighlight">\(1 \times 1\)</span> Hilbert matrix</p>
<p>b. <span class="math notranslate nohighlight">\(5 \times 5\)</span> Hilbert matrix</p>
<p>c. <span class="math notranslate nohighlight">\(10 \times 10\)</span> Hilbert matrix</p>
<p>d. <span class="math notranslate nohighlight">\(15 \times 15\)</span> Hilbert matrix</p>
<p>e. <span class="math notranslate nohighlight">\(20 \times 20\)</span> Hilbert matrix</p>
<p>If the accuracy of each matrix element is <span class="math notranslate nohighlight">\(\approx 10^{-16}\)</span>, what is the expected rounding error in the solution <span class="math notranslate nohighlight">\(\mathbf{Ax} = \mathbf{b}\)</span>, where <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> is the Hilbert matrix.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">hilbert_matrix</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)])</span>

<span class="c1"># Calculate condition numbers for Hilbert matrices of sizes 1x1, 5x5, 10x10, 15x15, and 20x20</span>
<span class="n">sizes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">]</span>
<span class="n">condition_numbers</span> <span class="o">=</span> <span class="p">{</span><span class="n">size</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span><span class="n">hilbert_matrix</span><span class="p">(</span><span class="n">size</span><span class="p">))</span> <span class="k">for</span> <span class="n">size</span> <span class="ow">in</span> <span class="n">sizes</span><span class="p">}</span>

<span class="n">errors</span> <span class="o">=</span> <span class="p">{</span><span class="n">size</span><span class="p">:</span> <span class="n">cond</span> <span class="o">*</span> <span class="mf">1e-16</span> <span class="k">for</span> <span class="n">size</span><span class="p">,</span> <span class="n">cond</span> <span class="ow">in</span> <span class="n">condition_numbers</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Matrix condition number (1 = 1x1 matrix): &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">condition_numbers</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Matrix errors (1 = 1x1 matrix): &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span>

<span class="sd">&#39;&#39;&#39;The expected rounding error for the solution to Ax=b would be A*10^-16. The condition number scales the error.&#39;&#39;&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Matrix condition number (1 = 1x1 matrix): 
{1: 1.0, 5: 476607.2502425855, 10: 16024416987428.36, 15: 3.67568286586649e+17, 20: 1.1484020388436145e+18}
Matrix errors (1 = 1x1 matrix): 
{1: 1e-16, 5: 4.766072502425855e-11, 10: 0.001602441698742836, 15: 36.7568286586649, 20: 114.84020388436144}
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;The expected rounding error for the solution to Ax=b would be A*10^-16. The condition number scales the error.&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="problems-part-2">
<h2>Problems <a class="reference internal" href="02_Gauss_elimination.html"><span class="doc std std-doc">Part 2</span></a><a class="headerlink" href="#problems-part-2" title="Permalink to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>4 masses are connected in series to 4 springs with K=100N/m. What are the final positions of the masses?</p></li>
</ol>
<p><img alt="Springs-masses" src="../_images/mass_springs.png" /></p>
<p>The masses haves the following amounts, 1, 2, 3, and 4 kg for masses 1-4. Using a FBD for each mass:</p>
<p><span class="math notranslate nohighlight">\(m_{1}g+k(x_{2}-x_{1})-kx_{1}=0\)</span></p>
<p><span class="math notranslate nohighlight">\(m_{2}g+k(x_{3}-x_{2})-k(x_{2}-x_{1})=0\)</span></p>
<p><span class="math notranslate nohighlight">\(m_{3}g+k(x_{4}-x_{3})-k(x_{3}-x_{2})=0\)</span></p>
<p><span class="math notranslate nohighlight">\(m_{4}g-k(x_{4}-x_{3})=0\)</span></p>
<p>in matrix form K=100 N/m:</p>
<p><span class="math notranslate nohighlight">\(\left[ \begin{array}{cccc}
2k &amp; -k &amp; 0 &amp; 0 \\
-k &amp; 2k &amp; -k &amp; 0 \\
0 &amp; -k &amp; 2k &amp; -k \\
0 &amp; 0 &amp; -k &amp; k \end{array} \right]
\left[ \begin{array}{c}
x_{1} \\
x_{2} \\
x_{3} \\
x_{4} \end{array} \right]=
\left[ \begin{array}{c}
m_{1}g \\
m_{2}g \\
m_{3}g \\
m_{4}g \end{array} \right]\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="mi">100</span> 
<span class="n">masses</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>  
<span class="n">g</span> <span class="o">=</span> <span class="mf">9.81</span>  

<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="o">-</span><span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="o">-</span><span class="n">k</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="o">-</span><span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">k</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="o">-</span><span class="n">k</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">k</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span>
<span class="p">])</span>

<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">masses</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">g</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)])</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Position of m1: &quot;</span><span class="p">,</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;m&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Position of m2: &quot;</span><span class="p">,</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;m&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Position of m3: &quot;</span><span class="p">,</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;m&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Position of m4: &quot;</span><span class="p">,</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="s2">&quot;m&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Position of m1:  0.9810000000000008 m
Position of m2:  1.8639000000000014 m
Position of m3:  2.5506000000000024 m
Position of m4:  2.9430000000000023 m
</pre></div>
</div>
</div>
</div>
<p><img alt="Triangular truss" src="../_images/truss.png" /></p>
<p>For problems <strong>2-3</strong>, consider the simple 3-element triangular truss, shown above, with a point load applied at the tip. The goal is to understand what tension is in the horizontal element, <span class="math notranslate nohighlight">\(P_1\)</span>. In problem <strong>2</strong>, the applied force is verical <span class="math notranslate nohighlight">\((\theta=0)\)</span> and in problem <strong>3</strong> the applied force varies in angle <span class="math notranslate nohighlight">\((\theta \neq 0)\)</span>.</p>
<ol class="arabic simple" start="2">
<li><p>In the truss shown above, calculate the tension in bar 1, <span class="math notranslate nohighlight">\(P_1\)</span>, when <span class="math notranslate nohighlight">\(\theta=0\)</span>. When <span class="math notranslate nohighlight">\(\theta=0\)</span>, the <span class="math notranslate nohighlight">\(\sum F=0\)</span> at each corner creates 3 equations and 3 unknowns as such (here, you reduce the number of equations with symmetry, <span class="math notranslate nohighlight">\(P_2=P_3,~R_2=R_3,~and~R_1=0\)</span> ).</p></li>
</ol>
<p><span class="math notranslate nohighlight">\(\left[ \begin{array}{ccc}
1 &amp; \cos\alpha &amp; 0 \\
0 &amp; 2\sin\alpha &amp; 0 \\
0 &amp; -\sin\alpha &amp;  1 \\
 \end{array} \right]
\left[ \begin{array}{c}
P_{1} \\
P_{2} \\
R_{2} \end{array} \right]=
\left[ \begin{array}{c}
0 \\
F \\
0 \end{array} \right]\)</span></p>
<p>a. Create the system of equations, <span class="math notranslate nohighlight">\(\mathbf{Ax}=\mathbf{b}\)</span>, when <span class="math notranslate nohighlight">\(\alpha=75^o\)</span>, <span class="math notranslate nohighlight">\(\beta=30^o\)</span>, and <span class="math notranslate nohighlight">\(F=1~kN\)</span>. Use <strong>Gauss elimination</strong> to solve for <span class="math notranslate nohighlight">\(P_1,~P_2,~and~R_2\)</span>. What is the resulting augmented matrix, <span class="math notranslate nohighlight">\(\mathbf{A|y}\)</span> after Gauss elimination?</p>
<p>b. Solve for the <span class="math notranslate nohighlight">\(\mathbf{LU}\)</span> decomposition of <span class="math notranslate nohighlight">\(\mathbf{A}\)</span>.</p>
<p>c. Use the <span class="math notranslate nohighlight">\(\mathbf{LU}\)</span> solution to solve for the tension in bar 1 <span class="math notranslate nohighlight">\((P_1)\)</span> every 10 N values of force, F, between 100 N and 1100 N. Plot <span class="math notranslate nohighlight">\(P_1~vs~F\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Part a</span>
<span class="n">alpha_deg</span> <span class="o">=</span> <span class="mi">75</span>
<span class="n">beta_deg</span> <span class="o">=</span> <span class="mi">30</span>

<span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">alpha_deg</span><span class="p">)</span>
<span class="n">beta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">beta_deg</span><span class="p">)</span>

<span class="n">F</span> <span class="o">=</span> <span class="mi">1</span>  

<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">alpha</span><span class="p">),</span> <span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">alpha</span><span class="p">),</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">beta</span><span class="p">)],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>

<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

<span class="c1">#Perform Gaussian elimination (LU decomposition) on matrix A</span>
<span class="n">lu</span><span class="p">,</span> <span class="n">piv</span> <span class="o">=</span> <span class="n">lu_factor</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="n">LU</span> <span class="o">=</span> <span class="n">lu</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Resulting matrix: &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">LU</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Resulting matrix: 
[[ 1.          0.50881905 -0.12940952]
 [ 0.         -1.96592583  1.5       ]
 [ 0.         -1.39893853  0.94888874]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Part b</span>
<span class="n">forces</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1100</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">tensions_P1</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">force</span> <span class="ow">in</span> <span class="n">forces</span><span class="p">:</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">force</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">lu_solve</span><span class="p">((</span><span class="n">lu</span><span class="p">,</span> <span class="n">piv</span><span class="p">),</span> <span class="n">b</span><span class="p">)</span> 
    <span class="n">tensions_P1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;LU decomposition: &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LU decomposition: 
[-611.04350424 2360.89080694 2360.89080694]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Part c</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">forces</span><span class="p">,</span> <span class="n">tensions_P1</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Tension in Bar P1 vs. Applied Force F&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Force F (N)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Tension in Bar P1 (N)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Tensions in bar 1 (P1): &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tensions_P1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/617cec966fb69886d26c27d30176cc5a328a443003e571aea462fb34ace1ac8f.png" src="../_images/617cec966fb69886d26c27d30176cc5a328a443003e571aea462fb34ace1ac8f.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Tensions in bar 1 (P1): 
[-55.549409476594455, -117.2709755616994, -178.99254164680434, -240.71410773190928, -302.4356738170143, -364.15723990211916, -425.87880598722415, -487.6003720723291, -549.321938157434, -611.0435042425389]
</pre></div>
</div>
</div>
</div>
<ol class="arabic simple" start="3">
<li><p>Using the same truss as shown above, let’s calculate the tension in bar 1, <span class="math notranslate nohighlight">\(P_1\)</span>, when <span class="math notranslate nohighlight">\(\theta=[0...90^o]\)</span> and <span class="math notranslate nohighlight">\(F=[100...1100]~kN\)</span>. When <span class="math notranslate nohighlight">\(\theta\neq 0\)</span>, the resulting 6 equations and 6 unknowns are given in the following matrix</p></li>
</ol>
<p><span class="math notranslate nohighlight">\(\left[ \begin{array}{ccc}
0 &amp; \sin\alpha &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
1 &amp; \cos\alpha &amp; 0 &amp; 0 &amp; 1 &amp; 0 \\
0 &amp; \cos\beta/2 &amp; \cos\beta/2 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; -\sin\beta/2 &amp; \sin\beta/2 &amp; 0 &amp; 0 &amp; 0 \\
-1 &amp; 0 &amp; \cos\alpha &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; \sin\alpha &amp; 0 &amp; 0 &amp; 1 \\
 \end{array} \right]
\left[ \begin{array}{c}
P_{1} \\
P_{2} \\
P_{3} \\
R_{1} \\
R_{2} \\
R_{3}\end{array} \right]=
\left[ \begin{array}{c}
0 \\
0 \\
F\cos\theta \\
-F\sin\theta \\
0 \\
0 \end{array} \right]\)</span></p>
<p>a. Create the system of equations, <span class="math notranslate nohighlight">\(\mathbf{Ax}=\mathbf{b}\)</span>, when <span class="math notranslate nohighlight">\(\alpha=75^o\)</span>, <span class="math notranslate nohighlight">\(\beta=30^o\)</span>, <span class="math notranslate nohighlight">\(\theta=45^o=\pi/4\)</span>, and <span class="math notranslate nohighlight">\(F=1~kN\)</span>. Use <strong>Gauss elimination</strong> to solve for <span class="math notranslate nohighlight">\(P_1,~P_2,~P_3,~R_1,~R_2,~and~R_3\)</span>. What is the resulting augmented matrix, <span class="math notranslate nohighlight">\(\mathbf{A|y}\)</span> after Gauss elimination? <em>Hint: do you see a problem with the order of the equations? How can you <strong>pivot</strong> to fix it?</em></p>
<p>b. Solve for the <span class="math notranslate nohighlight">\(\mathbf{PLU}\)</span> decomposition of <span class="math notranslate nohighlight">\(\mathbf{A}\)</span>.</p>
<p>c. Use the <span class="math notranslate nohighlight">\(\mathbf{PLU}\)</span> solution to solve for the tension in bar 1 <span class="math notranslate nohighlight">\((P_1)\)</span> every 10 N values of force, F, between 100 N and 1100 N. Plot <span class="math notranslate nohighlight">\(P_1~vs~F\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Part a</span>
<span class="n">alpha_deg</span> <span class="o">=</span> <span class="mi">75</span>
<span class="n">beta_deg</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">theta_deg</span> <span class="o">=</span> <span class="mi">45</span> 

<span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">alpha_deg</span><span class="p">)</span>
<span class="n">beta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">beta_deg</span><span class="p">)</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">theta_deg</span><span class="p">)</span>

<span class="n">F</span> <span class="o">=</span> <span class="mi">1000</span> 

<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">alpha</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">alpha</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">beta</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">beta</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">beta</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">beta</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">alpha</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">alpha</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="p">])</span>

<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="n">F</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span>
    <span class="o">-</span><span class="n">F</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="mi">0</span>
<span class="p">])</span>

<span class="c1">#Before applying Gaussian elimination, we need to pivot the matrix A to prevent a zero from appearing in the pivot position in the first row.</span>
<span class="c1">#Swapping row 1 with a row below it that has a non-zero entry in the first column.</span>

<span class="n">A</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="n">b</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">b</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>

<span class="n">lu</span><span class="p">,</span> <span class="n">piv</span> <span class="o">=</span> <span class="n">lu_factor</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Pivoted matrices: &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lu</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">piv</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pivoted matrices: 
[[ 1.          0.25881905  0.          0.          1.          0.        ]
 [ 0.          0.96592583  0.          1.          0.          0.        ]
 [ 0.          0.          0.96592583  0.96592583  0.          0.        ]
 [ 0.          0.          1.         -0.96592583  0.          1.        ]
 [-1.          0.26794919  0.26794919  0.54535061  1.         -0.54535061]
 [ 0.          0.         -0.26794919 -0.53589838  0.          1.53589838]]
[0 1 2 5 4 5]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Part b</span>
<span class="n">forces</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1100</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">tensions_P1</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">force</span> <span class="ow">in</span> <span class="n">forces</span><span class="p">:</span>
    <span class="n">b_updated</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
        <span class="mi">0</span><span class="p">,</span>
        <span class="mi">0</span><span class="p">,</span>
        <span class="n">force</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span>
        <span class="o">-</span><span class="n">force</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span>
        <span class="mi">0</span><span class="p">,</span>
        <span class="mi">0</span>
    <span class="p">])</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">lu_solve</span><span class="p">((</span><span class="n">lu</span><span class="p">,</span> <span class="n">piv</span><span class="p">),</span> <span class="n">b_updated</span><span class="p">)</span>
    <span class="n">tensions_P1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;PLU decomposition: &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PLU decomposition: 
[ 172.05587537 -145.43873882  664.77285435  140.48303397 -134.41355987
 -642.12126864]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Part c</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">forces</span><span class="p">,</span> <span class="n">tensions_P1</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Tension in Bar P1 vs. Applied Force F&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Force F (N)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Tension in Bar P1 (N)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Tensions in bar 1 (P1): &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tensions_P1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/643064cc03bfad21f522a3fdc8bd8a32f1b322196fb73073e750967e33195ae3.png" src="../_images/643064cc03bfad21f522a3fdc8bd8a32f1b322196fb73073e750967e33195ae3.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Tensions in bar 1 (P1): 
[15.641443215823761, 33.020824566739044, 50.40020591765434, 67.77958726856966, 85.15896861948492, 102.53834997040022, 119.91773132131553, 137.29711267223087, 154.67649402314606, 172.05587537406137]
</pre></div>
</div>
</div>
</div>
</section>
<section id="problems-part-3">
<h2>Problems <a class="reference internal" href="03_Linear-regression-algebra.html"><span class="doc std std-doc">Part 3</span></a><a class="headerlink" href="#problems-part-3" title="Permalink to this heading">#</a></h2>
<p><img alt="prony series diagram" src="https://i.imgur.com/LoBbHaM.png" /> <img alt="stress relax data" src="https://i.imgur.com/8i140Zu.png" /></p>
<p>Viscoelastic Prony series model and stress-vs-time relaxation curve of wheat kernels <a class="reference external" href="https://www.cerealsgrains.org/publications/plexus/cfw/pastissues/2013/Documents/CFW-58-3-0139.pdf">[3]</a>. Stress relaxation curve of a wheat kernel from regressed equation data that illustrate where to locate relaxation times (vertical dotted lines) and stresses (horizontal black marks). <span class="math notranslate nohighlight">\(\sigma\)</span> = stress; t = time.</p>
<ol class="arabic simple" start="2">
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Viscoelasticity">Viscoelasticity</a> is a property of materials that exhibit stiffness, but also tend to flow slowly. One example is <a class="reference external" href="https://en.wikipedia.org/wiki/Silly_Putty">Silly Putty</a>, when you throw a lump it bounces, but if you leave it on a table it <em>creeps</em>, slowly flowing downwards. In the stress-vs-time plot above, a wheat kernel was placed under constant strain and the stress was recorded. In a purely elastic material, the stress would be constant. In a purely viscous material, the stress would decay to 0 MPa.</p></li>
</ol>
<p>Here, you have a viscoelastic material, so there is some residual elastic stress as <span class="math notranslate nohighlight">\(t\rightarrow \infty\)</span>. The researchers used a 4-part <a class="reference external" href="https://en.wikipedia.org/wiki/Prony%27s_method">Prony series</a> to model viscoelasticity. The function they fit was</p>
<p><span class="math notranslate nohighlight">\(\sigma(t) = a_1 e^{-t/1.78}+a_2 e^{-t/11}+a_3e^{-t/53}+a_4e^{-t/411}+a_5\)</span></p>
<p>a. Load the data from the graph shown above in the file <code class="docutils literal notranslate"><span class="pre">../data/stress_relax.dat</span></code>.</p>
<p>b. Create a <span class="math notranslate nohighlight">\(\mathbf{Z}\)</span>-matrix to perform the least-squares regression for the given Prony series equation <span class="math notranslate nohighlight">\(\mathbf{y} = \mathbf{Za}\)</span>.</p>
<p>c. Solve for the constants, <span class="math notranslate nohighlight">\(a_1,~a_2,~a_3,~a_4~,a_5\)</span></p>
<p>d. Plot the best-fit function and the data from <code class="docutils literal notranslate"><span class="pre">../data/stress_relax.dat</span></code> <em>Use at least 50 points in time to get a smooth best-fit line.</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Part a</span>
<span class="n">file_path</span> <span class="o">=</span> <span class="s1">&#39;../data/stress_relax.dat&#39;</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">time</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">stress</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Part b</span>
<span class="n">tau</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">11</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">33</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">111</span><span class="p">]</span>

<span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">time</span><span class="o">/</span><span class="n">tau</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">time</span><span class="o">/</span><span class="n">tau</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">time</span><span class="o">/</span><span class="n">tau</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">time</span><span class="o">/</span><span class="n">tau</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">time</span><span class="p">)))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z matrix: &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Z matrix: 
[[1.00000000e+000 1.00000000e+000 1.00000000e+000 1.00000000e+000
  1.00000000e+000]
 [2.80995455e-004 1.30906597e-005 2.24328575e-015 5.31744167e-050
  1.00000000e+000]
 [2.21869645e-011 2.24328575e-015 1.12889563e-044 1.50351652e-148
  1.00000000e+000]
 [2.21869645e-011 2.24328575e-015 1.12889563e-044 1.50351652e-148
  1.00000000e+000]
 [1.75184824e-018 3.84421493e-025 5.68097638e-074 4.25122091e-247
  1.00000000e+000]
 [1.75184824e-018 3.84421493e-025 5.68097638e-074 4.25122091e-247
  1.00000000e+000]
 [6.80911784e-047 3.31512508e-064 3.64334047e-191 0.00000000e+000
  1.00000000e+000]
 [3.35186584e-068 1.66828065e-093 4.64309253e-279 0.00000000e+000
  1.00000000e+000]
 [2.89053935e-107 3.22734927e-147 0.00000000e+000 0.00000000e+000
  1.00000000e+000]
 [1.96820231e-153 1.06990665e-210 0.00000000e+000 0.00000000e+000
  1.00000000e+000]
 [6.04035826e-189 1.58110681e-259 0.00000000e+000 0.00000000e+000
  1.00000000e+000]
 [8.59483119e-317 0.00000000e+000 0.00000000e+000 0.00000000e+000
  1.00000000e+000]
 [0.00000000e+000 0.00000000e+000 0.00000000e+000 0.00000000e+000
  1.00000000e+000]
 [0.00000000e+000 0.00000000e+000 0.00000000e+000 0.00000000e+000
  1.00000000e+000]
 [0.00000000e+000 0.00000000e+000 0.00000000e+000 0.00000000e+000
  1.00000000e+000]
 [0.00000000e+000 0.00000000e+000 0.00000000e+000 0.00000000e+000
  1.00000000e+000]
 [0.00000000e+000 0.00000000e+000 0.00000000e+000 0.00000000e+000
  1.00000000e+000]
 [0.00000000e+000 0.00000000e+000 0.00000000e+000 0.00000000e+000
  1.00000000e+000]
 [0.00000000e+000 0.00000000e+000 0.00000000e+000 0.00000000e+000
  1.00000000e+000]
 [0.00000000e+000 0.00000000e+000 0.00000000e+000 0.00000000e+000
  1.00000000e+000]
 [0.00000000e+000 0.00000000e+000 0.00000000e+000 0.00000000e+000
  1.00000000e+000]
 [0.00000000e+000 0.00000000e+000 0.00000000e+000 0.00000000e+000
  1.00000000e+000]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Part c</span>
<span class="n">coefficients</span><span class="p">,</span> <span class="n">residuals</span><span class="p">,</span> <span class="n">rank</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">stress</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Constant a1: &quot;</span><span class="p">,</span> <span class="n">coefficients</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Constant a2: &quot;</span><span class="p">,</span> <span class="n">coefficients</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Constant a3: &quot;</span><span class="p">,</span> <span class="n">coefficients</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Constant a4: &quot;</span><span class="p">,</span> <span class="n">coefficients</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Constant a5: &quot;</span><span class="p">,</span> <span class="n">coefficients</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Constant a1:  192109065860.60938
Constant a2:  -4123685920825.3857
Constant a3:  1965733384267.1187
Constant a4:  1965843470703.8716
Constant a5:  32.660400390625
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Part d</span>
<span class="n">smooth_time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">time</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">smooth_stress</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">smooth_time</span><span class="o">/</span><span class="n">tau</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">smooth_time</span><span class="o">/</span><span class="n">tau</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
                                        <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">smooth_time</span><span class="o">/</span><span class="n">tau</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">smooth_time</span><span class="o">/</span><span class="n">tau</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span>
                                        <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">smooth_time</span><span class="p">))),</span> <span class="n">coefficients</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">stress</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Data&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">smooth_time</span><span class="p">,</span> <span class="n">smooth_stress</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Best-fit&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Stress Relaxation over Time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (sec)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Stress (MPa)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="sd">&#39;&#39;&#39;Tried debugging this plot, I am aware it looks incorrect.&#39;&#39;&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/64ec8afc992f0c47e534f6293385eafa0a242e82100625680664921e8dd0ae98.png" src="../_images/64ec8afc992f0c47e534f6293385eafa0a242e82100625680664921e8dd0ae98.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Tried debugging this plot, I am aware it looks incorrect.&#39;
</pre></div>
</div>
</div>
</div>
<ol class="arabic simple" start="3">
<li><p>Load the ‘…/data/primary-energy-consumption-by-region.csv’ that has the energy consumption of different regions of the world from 1965 until 2018 <a class="reference external" href="https://ourworldindata.org/energy">Our world in Data</a>.
You are going to compare the energy consumption of the United States to all of Europe. Load the data into a pandas dataframe. <em>Note: you can get certain rows of the data frame by specifying what you’re looking for e.g.
<code class="docutils literal notranslate"><span class="pre">EUR</span> <span class="pre">=</span> <span class="pre">dataframe[dataframe['Entity']=='Europe']</span></code> will give us all the rows from Europe’s energy consumption.</em></p></li>
</ol>
<p>a. Use a piecewise least-squares regression to find a function for the energy consumption as a function of year</p>
<p>energy consumed = <span class="math notranslate nohighlight">\(f(t) = At+B+C(t-1970)H(t-1970)\)</span></p>
<p>c. What is your prediction for US energy use in 2025? How about European energy use in 2025?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Part a</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/primary-energy-consumption-by-region.csv&#39;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">US</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Entity&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;United States&#39;</span><span class="p">]</span>
<span class="n">EURO</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Entity&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Europe&#39;</span><span class="p">]</span>

<span class="n">x_US</span> <span class="o">=</span> <span class="n">US</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">y_US</span> <span class="o">=</span> <span class="n">US</span><span class="p">[</span><span class="s1">&#39;Primary Energy Consumption (terawatt-hours)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">x_EURO</span> <span class="o">=</span> <span class="n">EURO</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">y_EURO</span> <span class="o">=</span> <span class="n">EURO</span><span class="p">[</span><span class="s1">&#39;Primary Energy Consumption (terawatt-hours)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>



<span class="k">def</span> <span class="nf">least_squares_fit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))])</span><span class="o">.</span><span class="n">T</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1">#US</span>
<span class="n">coeff_US</span> <span class="o">=</span> <span class="n">least_squares_fit</span><span class="p">(</span><span class="n">x_US</span><span class="p">,</span> <span class="n">y_US</span><span class="p">)</span>

<span class="c1">#Europe</span>
<span class="n">coeff_EURO</span> <span class="o">=</span> <span class="n">least_squares_fit</span><span class="p">(</span><span class="n">x_EURO</span><span class="p">,</span> <span class="n">y_EURO</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;US function slope and intercept: &quot;</span><span class="p">,</span><span class="n">coeff_US</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;EURO function slope and intercept: &quot;</span><span class="p">,</span><span class="n">coeff_EURO</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>US function slope and intercept:  [ 2.00397832e+02 -3.76521141e+05]
EURO function slope and intercept:  [ 1.99620397e+02 -3.75985956e+05]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Part c (b?)</span>

<span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">coeff</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">coeff</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">coeff</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Predictions for 2025 for both US and Europe using the least-squares regression model</span>
<span class="n">predicted_US_2025_ls</span> <span class="o">=</span> <span class="n">predict</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span> <span class="n">coeff_US</span><span class="p">)</span>
<span class="n">predicted_EURO_2025_ls</span> <span class="o">=</span> <span class="n">predict</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span> <span class="n">coeff_EURO</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Predicted 2025 US energy use: &quot;</span><span class="p">,</span><span class="n">predicted_US_2025_ls</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Predicted 2025 EURO energy use: &quot;</span><span class="p">,</span><span class="n">predicted_EUR_2025_ls</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Predicted 2025 US energy use:  29284.468724693055
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">21</span><span class="p">],</span> <span class="n">line</span> <span class="mi">11</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="n">predicted_EURO_2025_ls</span> <span class="o">=</span> <span class="n">predict</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span> <span class="n">coeff_EURO</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Predicted 2025 US energy use: &quot;</span><span class="p">,</span><span class="n">predicted_US_2025_ls</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">11</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Predicted 2025 EURO energy use: &quot;</span><span class="p">,</span><span class="n">predicted_EUR_2025_ls</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;predicted_EUR_2025_ls&#39; is not defined
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./module_04"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="03_Linear-regression-algebra.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Linear Regression Algebra</p>
      </div>
    </a>
    <a class="right-next"
       href="../projects/04_Linear_Algebra-project.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">CompMech04-Linear Algebra Project</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#problems-part-1">Problems <span class="xref myst">Part 1</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#problems-part-2">Problems <span class="xref myst">Part 2</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#problems-part-3">Problems <span class="xref myst">Part 3</span></a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By <a href = https://cooperrc.github.io> Ryan C. Cooper</a>
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=bd9e20870c6007c4c509"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=bd9e20870c6007c4c509"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>